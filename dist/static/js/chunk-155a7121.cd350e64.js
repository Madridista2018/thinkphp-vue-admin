(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-155a7121"],{"483f":function(t,e,s){},"5f82":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("my-header",{attrs:{title:t.title}}),t._v(" "),s("div",{staticClass:"filter-form"},[s("el-row",[s("el-col",{attrs:{span:10}},[s("el-form",{ref:"filter",attrs:{"label-position":"left"}},[s("el-form-item",{attrs:{label:"商圈名称:","label-width":"80px"}},[s("el-col",{attrs:{span:12}},[s("el-input",{model:{value:t.search_superstore_name,callback:function(e){t.search_superstore_name=e},expression:"search_superstore_name"}})],1),t._v(" "),s("el-col",{staticClass:"line",attrs:{span:1}}),t._v(" "),s("el-col",{attrs:{span:5}},[s("el-button",{attrs:{type:"primary"},on:{click:t.summit_search}},[t._v("查找")])],1)],1)],1)],1),t._v(" "),s("el-col",{attrs:{span:10}},[s("span",[t._v("\n          商圈总数:\n          "),s("font",{staticClass:"font-title"},[t._v(t._s(t.superstore_total))]),t._v(" |\n        ")],1),t._v(" "),s("span",[t._v("\n          店铺总数:\n          "),s("font",{staticClass:"font-title"},[t._v(t._s(t.store_total))]),t._v(" |\n        ")],1),t._v(" "),s("span",[t._v("\n          当前在线折扣总数:\n          "),s("font",{staticClass:"font-title"},[t._v(t._s(t.discount_total))])],1),t._v(" "),s("br"),t._v(" "),s("span",[t._v("\n          昨日上线折扣总数:\n          "),s("font",{staticClass:"font-title"},[t._v(t._s(t.yesterdat_discount))]),t._v(" |\n        ")],1),t._v(" "),s("span",[t._v("\n          今日上线折扣总数:\n          "),s("font",{staticClass:"font-title"},[t._v(t._s(t.today_discount))])],1)])],1),t._v(" "),s("el-row",[s("el-col",{staticClass:"filter-tool",attrs:{span:10}},[s("el-form",[s("el-button",{attrs:{type:"primary"},on:{click:t.add_superstore}},[t._v("添加商圈")]),t._v(" "),s("el-button",{on:{click:t.filter_lower}},[t._v("下架")]),t._v(" "),s("el-button",{on:{click:t.filter_online}},[t._v("上架")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.filter_delete}},[t._v("删除")])],1)],1)],1)],1),t._v(" "),s("my-table",{attrs:{tableData:t.list,columns:t.columns,loading:t.table_loading},on:{handleSelectionChange:t.handleSelectionChange}}),t._v(" "),s("Pagination",{attrs:{pagesize:t.pagesize,current_page:t.current_page,pageSizes:t.pageSizes,total:t.total},on:{changeCurrentPage:t.changeCurrentPage,changeSizePage:t.changeSizePage}}),t._v(" "),s("div",{staticClass:"message"},[s("el-dialog",{attrs:{title:"商圈详情",visible:t.simpleVisible,width:"30%"},on:{"update:visible":function(e){t.simpleVisible=e}}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.simple_loading,expression:"simple_loading"}]},[s("ul",[s("li",[s("span",{staticClass:"sueper_name"},[t._v("商圈名称:")]),t._v(" "),s("span",{staticClass:"param",attrs:{title:t.simpleData.superstore_name}},[t._v(t._s(t.simpleData.superstore_name))])]),t._v(" "),s("li",[s("span",{staticClass:"sueper_name"},[t._v("类型:")]),t._v(" "),s("span",{staticClass:"param",attrs:{title:t.simpleData.type_}},[t._v(t._s(t.simpleData.type_))])]),t._v(" "),s("li",[s("span",{staticClass:"sueper_name"},[t._v("人气值:")]),t._v(" "),s("span",{staticClass:"param",attrs:{title:t.simpleData.popularity}},[t._v(t._s(t.simpleData.popularity))])]),t._v(" "),s("li",[s("span",{staticClass:"sueper_name"},[t._v("经纬度:")]),t._v(" "),s("span",{staticClass:"param",attrs:{title:t.simpleData.longitude}},[t._v(t._s(t.simpleData.longitude)+" , "+t._s(t.simpleData.latitude))])]),t._v(" "),s("li",{on:{mouseenter:function(e){return t.show_(2,e)},mouseover:function(e){return t.hidden_(2,e)}}},[s("span",{staticClass:"sueper_name"},[t._v("营业时间:")]),t._v(" "),s("span",{staticClass:"param",attrs:{title:t.simpleData.do_business}},[t._v(t._s(t.simpleData.do_business))])]),t._v(" "),s("li",[s("span",{staticClass:"sueper_name"},[t._v("地址:")]),t._v(" "),s("span",{staticClass:"param",attrs:{title:t.simpleData.address}},[t._v(t._s(t.simpleData.address))])])])])])],1),t._v(" "),s("el-dialog",{attrs:{title:t.inputSuperStoreTitle,visible:t.inputSuperStore},on:{"update:visible":function(e){t.inputSuperStore=e}}},[s("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.edit_loadding,expression:"edit_loadding"}],ref:"superstore_form",attrs:{model:t.superstore_form,"label-width":"80px",rules:t.rules}},[s("el-form-item",{attrs:{label:"商圈名称",prop:"superstore_name"}},[s("el-input",{attrs:{"auto-complete":"off"},model:{value:t.superstore_form.superstore_name,callback:function(e){t.$set(t.superstore_form,"superstore_name",e)},expression:"superstore_form.superstore_name"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"商圈类型",prop:"type"}},[s("el-col",{attrs:{span:26}},[s("el-select",{attrs:{placeholder:"请选择商圈类型"},model:{value:t.superstore_form.type,callback:function(e){t.$set(t.superstore_form,"type",e)},expression:"superstore_form.type"}},t._l(t.types,function(t,e){return s("el-option",{key:e,attrs:{value:t.key,label:t.value}})}),1)],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"是否上架",prop:"type"}},[s("el-col",{attrs:{span:26}},[s("el-select",{attrs:{placeholder:"是否上架"},model:{value:t.superstore_form.status,callback:function(e){t.$set(t.superstore_form,"status",e)},expression:"superstore_form.status"}},[s("el-option",{attrs:{value:"上架",label:"上架"}},[t._v("上架")]),t._v(" "),s("el-option",{attrs:{value:"下架",label:"下架"}},[t._v("下架")])],1)],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"人气值",prop:"popularity"}},[s("el-input",{model:{value:t.superstore_form.popularity,callback:function(e){t.$set(t.superstore_form,"popularity",e)},expression:"superstore_form.popularity"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"经纬度",inline:!0,prop:"longitude_latitude"}},[s("el-col",{attrs:{span:8}},[s("el-input",{model:{value:t.superstore_form.longitude,callback:function(e){t.$set(t.superstore_form,"longitude",e)},expression:"superstore_form.longitude"}})],1),t._v(" "),s("el-col",{staticClass:"line",attrs:{span:2}},[t._v("-")]),t._v(" "),s("el-col",{attrs:{span:8}},[s("el-input",{model:{value:t.superstore_form.latitude,callback:function(e){t.$set(t.superstore_form,"latitude",e)},expression:"superstore_form.latitude"}})],1),t._v(" "),s("el-col",{staticClass:"line",attrs:{span:2}},[t._v("-")]),t._v(" "),s("el-col",{attrs:{span:3}},[s("el-button",{attrs:{type:"primary"},on:{click:t.onAddress}},[t._v("选址")])],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"营业时间",prop:"do_business"}},[s("el-input",{model:{value:t.superstore_form.do_business,callback:function(e){t.$set(t.superstore_form,"do_business",e)},expression:"superstore_form.do_business"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"地址",prop:"address"}},[s("el-input",{model:{value:t.superstore_form.address,callback:function(e){t.$set(t.superstore_form,"address",e)},expression:"superstore_form.address"}})],1)],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.cacheEdit=!1}}},[t._v("取 消")]),t._v(" "),"编辑商圈"==t.inputSuperStoreTitle?s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.confirmUpdate("superstore_form")}}},[t._v("更新")]):t._e(),t._v(" "),"添加商圈"==t.inputSuperStoreTitle?s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.confirmCreate("superstore_form")}}},[t._v("创建")]):t._e()],1)],1),t._v(" "),s("el-dialog",{staticClass:"amap-body",attrs:{title:"地图",visible:t.amap},on:{"update:visible":function(e){t.amap=e}}},[s("div",{staticClass:"dialog-content amap-content"},[s("el-amap",{staticClass:"amap-demo",attrs:{vid:"amapDemo",center:t.center,zoom:t.zoom,events:t.events}}),t._v(" "),s("span",{staticStyle:{color:"red"}},[t._v("\n        "+t._s(t.superstore_form.longitude)+" - "+t._s(t.superstore_form.latitude)+"\n        "),s("br"),t._v("\n        "+t._s(t.superstore_form.address)+"\n      ")])],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.amap=!1}}},[t._v("确 定")])],1)])],1)},o=[],a=s("cd4a"),i={name:"SuperStore",mounted:function(){this.getList(),this.getDataInfo()},components:{myHeader:a["k"],MyTag:a["MyTag"],MyTable:a["f"],MyDropDown:a["d"],Pagination:a["i"]},mixins:[a["l"]],data:function(){var t=this,e=this;return{id:0,title:"商圈详情",inputSuperStoreTitle:"编辑商圈",table_loading:!0,simple_loading:!0,edit_loadding:!0,list:[],simpleData:{},simpleVisible:!1,inputSuperStore:!1,amap:!1,visible:!1,superstore_form:{},superstore_total:0,store_total:0,discount_total:0,today_discount:0,yesterdat_discount:0,search_superstore_name:"",columns:[{prop:"id",label:"ID",width:"55"},{prop:"superstore_name",label:"商圈名称"},{prop:"type_",label:"商圈类型",render:function(t,e){return t(a["MyTag"],{props:{size:"medium",text:e.row.type_}})}},{prop:"store_num",label:"店铺数量",width:"105"},{prop:"discount_num",label:"折扣数量",width:"135"},{prop:"remark",label:"备注"},{prop:"",fixed:"right",label:"操作",render:function(e,s){var r={label:"更多"},o=[{label:"详情",func:{func:"showDetail",id:s.row.id}},{label:"编辑",func:{func:"edit",id:s.row.id}},{label:"所有店铺",func:{func:"go_store",id:s.row.id}}];return 1==s.row.status?r.items=[{label:"下架",func:{func:"lower",id:s.row.id}},{label:"删除",func:{func:"delete",id:s.row.id}}]:r.items=[{label:"上架",func:{func:"online",id:s.row.id}},{label:"删除",func:{func:"delete",id:s.row.id}}],e(a["d"],{props:{dropDownData:r,buttons:o},on:{lower:t.lower,delete:t.delete,online:t.online,edit:t.edit,go_store:t.go_store,showDetail:t.showDetail}})}}],types:[{key:0,value:"未分类"},{key:1,value:"大型商城"},{key:2,value:"购物中心"}],rules:{superstore_name:[{required:!0,message:"请输入商圈名称",trigger:"blur"},{mix:2,max:100,message:"输入的字符串在2-100个之间",trigger:"blur"}],popularity:[{required:!0,message:"人气值",trigger:"blur"}],do_business:[{required:!0,message:"请输入营业时间",trigger:"blur"}],address:[{required:!0,message:"请输入地址",trigger:"blur"}]},zoom:12,center:[114.12593,22.649967],events:{click:function(t){var s=t.lnglat,r=s.lng,o=s.lat;e.superstore_form.longitude=r,e.superstore_form.latitude=o;var a=new AMap.Geocoder({radius:1e3,extensions:"all"});new AMap.Autocomplete({input:"amap_search"});a.getAddress([r,o],function(t,s){"complete"===t&&"OK"===s.info&&s&&s.regeocode&&(e.superstore_form.address=s.regeocode.formattedAddress,e.$nextTick())})}},lng:0,lat:0}},methods:{edit:function(t){this.inputSuperStoreTitle="编辑商圈",this.inputSuperStore=!0,this.getSimple(t),this.edit_loadding=!1},getList:function(){var t=this;this.$get("/api/superstore",{page:this.current_page,pagesize:this.pagesize}).then(function(e){t.list=e.data.list,t.setPage(e.data),t.table_loading=!1})},showDetail:function(t){this.getSimple(t),this.simpleVisible=!0,this.simple_loading=!1},getSimple:function(t){var e=this;this.id=t,this.$get("/api/superstore/".concat(t)).then(function(t){200==t.code&&(e.simpleData=t.data,e.superstore_form=t.data,1==e.superstore_form.status?e.superstore_form.status="上架":e.superstore_form.status="下架")})},show_:function(t,e){console.log(e.target)},hidden_:function(t,e){console.log(e)},cacheEdit:function(){},updateData:function(t){var e=this,s={superstore_name:t.superstore_name,longitude:t.longitude,latitude:t.latitude,type:t.type,popularity:t.popularity,do_business:t.do_business,address:t.address,status:"上架"==t.status?1:2};this.$put("/api/superstore/"+this.id,s).then(function(t){200==t.code?(e.edit_loadding=!1,e.$success_("更新成功"),e.getList()):e.$error_(t.msg)})},onAddress:function(){this.amap=!0,this.superstore_form.longitude&&(this.center=[this.superstore_form.longitude,this.superstore_form.latitude])},lower:function(t){var e=this;this.$post("/api/superstore/lower/".concat(t)).then(function(t){200==t.code?(e.$success_("下架成功"),e.getList()):e.$error_(t.msg)})},online:function(t){var e=this;console.log(t),this.$post("/api/superstore/online/".concat(t)).then(function(t){200==t.code?(e.$success_("上架成功"),e.getList()):e.$error_(t.msg)})},delete:function(t){var e=this;this.$confirm("是否删除当前商圈,请谨慎","是否删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$deletes("/api/superstore/".concat(t)).then(function(t){200==t.code?(e.$success_("删除成功"),e.getList()):e.$error_(t.msg)})})},tableRowClassName:function(t){var e=t.row;if(2==e.status)return e.remark="- 已下架","color-lower"},summit_search:function(){var t=this;this.$get("/api/superstore?keyword="+this.search_superstore_name).then(function(e){t.list=e.data.list,t.setPage(e.data),t.table_loading=!1,t.$success_("搜索成功")})},add_superstore:function(){this.edit_loadding=!1,this.inputSuperStore=!0,this.superstore_form=Object.assign({},{inputSuperStore:!0,inputSuperStoreTitle:"添加商圈",edit_loadding:!1,type:1,status:"上架",popularity:5})},confirmCreate:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;console.log(e.superstore_form),e.edit_loadding=!0,e.post_superstore(e.superstore_form)})},confirmUpdate:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.edit_loadding=!0,e.updateData(e.superstore_form)})},post_superstore:function(t){var e={superstore_name:t.superstore_name,longitude:t.longitude,latitude:t.latitude,type:t.type,popularity:t.popularity,do_business:t.do_business,address:t.address,status:t.status},s=this;this.$post("/api/superstore",e).then(function(t){200==t.code?(s.$success_("创建成功"),s.getList(),s.edit_loadding=!1,s.inputSuperStore=!1):(s.edit_loadding=!1,s.$error_(t.msg))})},filter_online:function(){var t=this;this.getSelected();var e=this.multipleSelectionIds.join(",");this.$post("/api/superstore/batch_online?ids=".concat(e)).then(function(e){200==e.code?(t.$success_("上架成功"),t.getList()):t.$error_(e.msg)})},filter_lower:function(){var t=this;this.getSelected();var e=this.multipleSelectionIds.join(",");this.$post("/api/superstore/batch_lower?ids=".concat(e)).then(function(e){200==e.code?(t.$success_("下架成功"),t.getList()):t.$error_(e.msg)})},filter_delete:function(){this.$error_("暂时关闭批量删除接口")},go_store:function(t){localStorage.setItem("superstore_id",t),this.$router.push({path:"/store"})},getDataInfo:function(){var t=this;this.$get("/api/gather").then(function(e){200==e.code&&(t.superstore_total=e.data.superstore_total,t.store_total=e.data.store_total,t.discount_total=e.data.discount_total,t.today_discount=e.data.today_discount,t.yesterdat_discount=e.data.yesterdat_discount)})}}},n=i,l=(s("d14c"),s("0c7c")),u=Object(l["a"])(n,r,o,!1,null,null,null);e["default"]=u.exports},d14c:function(t,e,s){"use strict";var r=s("483f"),o=s.n(r);o.a}}]);